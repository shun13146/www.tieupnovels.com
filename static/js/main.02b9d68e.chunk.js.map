{"version":3,"sources":["fetcherimpl/BackendNovelFetcher.ts","metaProcessor.ts","components/constants.ts","components/Page.tsx","App.tsx","plugins/rubyPlugin.ts","utils/Tweener.ts","plugins/playMusicPlugin.tsx","plugins/animatedBackgroundPlugin.tsx","serviceWorker.ts","index.tsx","fetcherimpl/NovelFetchError.ts"],"names":["fetchMode","mode","credentials","redirect","BackendNovelFetcherImpl","base_path","ep_suffix","meta_suffix","base","episode_prefix","meta_prefix","this","novel_id","fetch","data","NovelFetchError","type","phase","detail","ok","json","meta","eposode_id","ep","episode","Error","query","meta_processors","text_span","text_line","initializer","finalizer","child_component","view_component","registerInitializer","func","find","it","push","registerFinalizer","registerComponent","id","force","st","console","warn","registerMetaProcessor","hasOwnProperty","unregisterMetaProcessor","pages","a","default","Page","props","state","UNSAFE_componentWillReceiveProps","next","path","target","matcher","pkeys","Object","keys","idx","length","key","startsWith","RegExp","substr","test","log","setState","content","undefined","then","title","document","getElementsByTagName","window","location","hash","consts","textContent","scrollIntoView","block","className","Content","to","src","alt","notFound","React","Component","App","hashType","component","value","Tweener","callback","fixed","timestamp","previous","animationId","frame","performance","now","time","count","delta","overall","setTimeout","requestAnimationFrame","audio","players","muted","volumeInternal","entries","forEach","remove","file","aud","Audio","style","display","volume","loop","body","appendChild","dir","player","tn","timing","pause","play","start","fade","duration","paused","enabled","custom_data","res","resources","addTrack","clearTrack","_","opts","displaying","MusicControlPanel","htmlFor","defaultChecked","onChange","evt","checked","min","max","parseFloat","forceUpdate","width","storage","images","videos","AnimatedBackground","changeBackground","val","scroll_dir","animtime","animtype","shown_background","animation_options","default_background","animationDuration","map","backgroundImage","Boolean","hostname","match","BackendNovelFetcher","initialize","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister","mapSeverityToLevel","unknown","error","critical","source","level"],"mappings":"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","file":"static/js/main.02b9d68e.chunk.js","sourcesContent":["/* eslint-disable class-methods-use-this, no-unused-vars */\nimport NovelFetchError from './NovelFetchError';\n\nconst fetchMode: RequestInit = {\n  mode: 'cors',\n  credentials: 'include',\n  redirect: 'follow',\n};\n\nclass BackendNovelFetcherImpl implements NovelFetcher {\n  private base_path: string = '/novels';\n\n  private ep_suffix: string = '.episode.json';\n\n  private meta_suffix: string = '.m.json';\n\n  initialize(\n    {\n      base,\n      episode_prefix,\n      meta_prefix,\n    }: {\n      base?: string,\n      episode_prefix?: string,\n      meta_prefix?: string\n    },\n  ) {\n    this.base_path = typeof base !== 'undefined' ? base : this.base_path;\n    this.ep_suffix = typeof episode_prefix !== 'undefined' ? episode_prefix : this.ep_suffix;\n    this.meta_suffix = typeof meta_prefix !== 'undefined' ? meta_prefix : this.meta_suffix;\n  }\n\n  async fetchNovel(novel_id: string): Promise<NovelMeta> {\n    let data;\n    try {\n      data = await fetch(`${this.base_path}/${novel_id}/meta${this.meta_suffix}`, fetchMode);\n    } catch (err) {\n      throw new NovelFetchError({ type: 'unknown', phase: 'fetch', detail: err });\n    }\n\n    if (!data.ok) {\n      throw new NovelFetchError('novel_not_found');\n    }\n\n    let meta;\n    try {\n      meta = (await data.json()) as NovelMeta;\n    } catch (err) {\n      throw new NovelFetchError({ type: 'unknown', phase: 'parse', detail: err });\n    }\n    return meta;\n  }\n\n  async fetchEpisode(\n    novel_id: string,\n    eposode_id: string,\n  ): Promise<FetchedEpisodeData> {\n    let data;\n    try {\n      data = await fetch(`${this.base_path}/${novel_id}/meta${this.meta_suffix}`, fetchMode);\n    } catch (err) {\n      throw new NovelFetchError({ type: 'unknown', phase: 'fetch', detail: err });\n    }\n\n    if (!data.ok) {\n      throw new NovelFetchError('novel_not_found');\n    }\n\n    let meta;\n    try {\n      meta = (await data.json()) as NovelMeta;\n    } catch (err) {\n      throw new NovelFetchError({ type: 'unknown', phase: 'parse', detail: err });\n    }\n\n    let ep;\n    try {\n      ep = await fetch(`${this.base_path}/${novel_id}/${eposode_id}${this.ep_suffix}`, fetchMode);\n    } catch (err) {\n      throw new NovelFetchError({ type: 'unknown', phase: 'fetch', detail: err });\n    }\n    if (!ep.ok) {\n      throw new NovelFetchError('episode_not_found');\n    }\n\n    let episode;\n    try {\n      episode = (await ep.json()) as Episode;\n    } catch (err) {\n      throw new NovelFetchError({ type: 'unknown', phase: 'parse', detail: err });\n    }\n\n    return { meta, episode };\n  }\n\n  fetchEpisodeList(novel_id: string): Promise<EpisodeMeta[]> {\n    throw new Error('Method not implemented.');\n  }\n\n  searchNovel(query: string): Promise<KeyedStorage<NovelMeta>> {\n    throw new Error('Method not implemented.');\n  }\n}\n\nexport default new BackendNovelFetcherImpl();\n","export const meta_processors: MetaProcessorStorage = {\n  text_span: {},\n  text_line: {},\n  initializer: [],\n  finalizer: [],\n  child_component: {},\n  view_component: {},\n};\n\nexport function registerInitializer(\n  func: ProcessorInitializer,\n  allow_duplication: boolean = false,\n) {\n  if (!allow_duplication && meta_processors.initializer.find((it) => it === func)) {\n    return;\n  }\n  meta_processors.initializer.push(func);\n}\n\nexport function registerFinalizer(\n  func: ProcessorFinalizer,\n  allow_duplication: boolean = false,\n) {\n  if (!allow_duplication && meta_processors.finalizer.find((it) => it === func)) {\n    return;\n  }\n  meta_processors.finalizer.push(func);\n}\n\nexport function registerComponent(\n  type: 'view' | 'child',\n  id: string,\n  func: React.FC,\n  force?: boolean,\n) {\n  const st = (meta_processors[`${type}_component` as keyof MetaProcessorStorage] as any | undefined);\n  if (!st) {\n    console.warn(`unknown storage type: '${type}'`);\n    return;\n  }\n  if (!st[id] || force) {\n    st[id] = func;\n  }\n}\n\nexport function unregisterComponent(type: 'view' | 'child', id: string) {\n  delete (meta_processors[`${type}_component` as keyof MetaProcessorStorage] as any)[id];\n}\n\nexport function registerMetaProcessor(type: 'span', id: string, func: TextSpanMetaProcessor, force?: boolean): void\nexport function registerMetaProcessor(type: 'line', id: string, func: LineMetaProcessor, force?: boolean): void\nexport function registerMetaProcessor(\n  type: 'line' | 'span',\n  id: string,\n  func: LineMetaProcessor | TextSpanMetaProcessor,\n  force?: boolean,\n): void {\n  if (type === 'line') {\n    if (force || !meta_processors.text_line.hasOwnProperty(id)) {\n      meta_processors.text_line[id] = func as LineMetaProcessor;\n    }\n  } else if (type === 'span') {\n    if (force || !meta_processors.text_span.hasOwnProperty(id)) {\n      meta_processors.text_span[id] = func as TextSpanMetaProcessor;\n    }\n  } else {\n    console.warn(`unknown storage type: '${type}'`);\n  }\n}\n\nexport function unregisterMetaProcessor(type: 'line' | 'span', id: string) {\n  delete (meta_processors[`text_${type}` as keyof MetaProcessorStorage] as any)[id];\n}\n","export default {\n  site_title: 'たいあっぷ！',\n};\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport consts from './constants';\n\ntype Props = {path?: string};\ntype LoadError = 'NOT FOUND';\n\nconst pages: {[key: string]: () => Promise<React.FC>} = {\n  '/': async () => (await import('./pages/Top')).default,\n  're^/view/[a-zA-Z0-9]{8}/?$': async () => (await import('./pages/IndexPage')).default,\n  're^/view/[a-zA-Z0-9]{8}/[0-9]+$': async () => (await import('./pages/View')).default,\n};\n\nconst checkPathMatches = (target: string, matcher: RegExp | string) => {\n  if (typeof matcher === 'string') {\n    return target === matcher;\n  }\n  return matcher.test(target);\n};\n\nclass Page extends React.Component<Props, {content?: React.FC | LoadError}> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    this.UNSAFE_componentWillReceiveProps(this.props);\n  }\n\n  UNSAFE_componentWillReceiveProps(next: Props) {\n    if (!next.path) {\n      return;\n    }\n\n    const pkeys = Object.keys(pages);\n\n    for (let idx = 0; idx < pkeys.length; idx++) {\n      const key = pkeys[idx];\n\n      if (checkPathMatches(next.path, key.startsWith('re^') ? new RegExp(key.substr(2)) : key)) {\n        console.log(`matched ${key}`);\n        this.setState({ content: undefined });\n        pages[key]().then((it) => this.setState({ content: it }));\n        return;\n      }\n    }\n\n    this.setState({ content: 'NOT FOUND' });\n  }\n\n  componentDidUpdate() {\n    const title = document.getElementsByTagName('h1')[0];\n    if (!title || window.location.hash === '#/') {\n      document.title = consts.site_title;\n      return;\n    }\n    document.title = `${consts.site_title} | ${(title.textContent || 'ロード中...')}`;\n    title.scrollIntoView({ block: 'end' });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  notFound() {\n    return (\n      <div className=\"not-found\">\n        <h1>要求されたページが見つかりませんでした</h1>\n        <p>\n          要求されたページが見つかりませんでした。\n          入力したURLが正しいか確認してください。\n        </p>\n        <p>\n          もし、リンクをたどってこのページが表示された場合は、お手数ですがサイトの管理者に連絡していただけるとありがたく思います。\n          大変ご迷惑をおかけいたしました。\n        </p>\n      </div>\n    );\n  }\n\n  render() {\n    const Content = this.state.content;\n    return (\n      <main className=\"contents-body\">\n        <div className=\"heading\">\n          <div className=\"site-logo\">\n            <Link to=\"/\"><img src=\"/header.png\" alt=\"たいあっぷ！\" /></Link>\n          </div>\n          <div className=\"site-copy\">「作品」を「傑作」に変えよう。</div>\n        </div>\n        {/* eslint-disable-next-line no-nested-ternary */}\n        {Content !== undefined ? Content !== 'NOT FOUND' ? <Content /> : this.notFound() : <div className=\"spinner\" />}\n        <div className=\"footing\">\n          <div className=\"footer-group\">\n            <div className=\"site-logo footer-item\">\n              <Link to=\"/\"><img src=\"/header.png\" alt=\"たいあっぷ！\" /></Link>\n            </div>\n            <div className=\"footer-item site-copy\">「作品」を「傑作」に変えよう。</div>\n          </div>\n          <div className=\"footer-group\">\n            <div className=\"footer-item\">\n              <span>サイト案内</span>\n            </div>\n            <div className=\"footer-item\">\n              <span>ヘルプ</span>\n            </div>\n          </div>\n          <div className=\"footer-group centering\">\n            <div className=\"footer-item\">&copy; 2019 Nishii Yun</div>\n          </div>\n        </div>\n      </main>\n    );\n  }\n}\n\nexport default Page;\n","import React from 'react';\nimport { HashRouter, Route } from 'react-router-dom';\nimport Page from './components/Page';\n\n// import { HumburgerMenu, MenuItemGroup, MenuItem } from './components/HumburgerMenu';\n\n/*const Menu = () => (\n  <HumburgerMenu>\n    <MenuItemGroup title=\"SNS\">\n      <MenuItem intralink={false} linksTo=\"https://twitter.com/\" text=\"Twitter\" />\n      <MenuItem intralink={false} linksTo=\"https://facebook.com/\" text=\"Facebook\" />\n      <MenuItem intralink={false} linksTo=\"https://youtube.com/\" text=\"YouTube\" />\n      <MenuItem intralink={false} linksTo=\"https://instagram.com/\" text=\"Instagram\" />\n    </MenuItemGroup>\n  </HumburgerMenu>\n);*/\n\nconst App: React.FC = () => (\n  <HashRouter {...{ hashType: 'slash' }}>\n    <div className=\"App\">\n      <Route\n        path=\"/\"\n        component={() => <Page path={window.location.hash.substr(1)} />}\n      />\n    </div>\n  </HashRouter>\n);\n\nexport default App;\n","import { registerMetaProcessor } from '../metaProcessor';\n\nregisterMetaProcessor('span', 'ruby', (value, props) => {\n  props['data-ruby'] = value;\n});\n\nexport default {};\n","interface Time {\r\n  count: number;\r\n  delta: number | null;\r\n  overall: number;\r\n}\r\n\r\nexport default class Tweener {\r\n  timestamp: number | null = null;\r\n\r\n  previous: number | null = null;\r\n\r\n  animationId: number | null = null;\r\n\r\n  constructor(\r\n    public callback: { (time: Time): boolean },\r\n    public fixed: boolean = false\r\n  ) {\r\n  }\r\n\r\n  start() {\r\n    if (this.fixed) {\r\n      this.animationId = setTimeout(this.frame, 33) as any;\r\n    } else {\r\n      this.animationId = requestAnimationFrame(this.frame);\r\n    }\r\n  }\r\n\r\n  frame = () => {\r\n    const frame = performance.now();\r\n    if (this.timestamp === null) {\r\n      this.timestamp = frame;\r\n    }\r\n\r\n    const time = {\r\n      count: frame - this.timestamp,\r\n      delta: this.previous === null ? null : frame - this.previous,\r\n      overall: frame,\r\n    };\r\n\r\n    this.previous = frame;\r\n\r\n    if (this.callback(time)) {\r\n      if (this.fixed) {\r\n        this.animationId = setTimeout(this.frame, 33) as any;\r\n      } else {\r\n        this.animationId = requestAnimationFrame(this.frame);\r\n      }\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    this.timestamp = null;\r\n  }\r\n}\r\n","/* eslint-disable max-classes-per-file */\nimport React, { Component } from 'react';\nimport {\n  registerMetaProcessor,\n  registerComponent,\n  registerInitializer,\n  registerFinalizer,\n} from '../metaProcessor';\nimport Tweener from '../utils/Tweener';\n\nclass AudioTrack {\n  private players: {[id: string]: HTMLAudioElement};\n\n  private muted?: number;\n\n  private volumeInternal: number = 0.5;\n\n  constructor() {\n    this.players = {};\n  }\n\n  clearTrack() {\n    Object.entries(this.players).forEach((it) => it[1].remove());\n    this.players = {};\n  }\n\n  addTrack(id: string, file: string, force?: boolean) {\n    if (!this.players.hasOwnProperty(id) || force) {\n      const aud = new Audio();\n      aud.src = file;\n      aud.style.display = 'none';\n      aud.volume = this.volumeInternal;\n      aud.loop = true;\n      this.players[id] = aud;\n      document.body.appendChild(aud);\n    }\n  }\n\n  fade(id: string, dir: 'start' | 'stop', time: number = 1000) {\n    const player = this.players[id];\n    const tn = new Tweener((timing) => {\n      if (dir === 'stop') {\n        if (timing.count === 0) {\n          player.volume = this.volumeInternal;\n          return true;\n        }\n        if (time < timing.count) {\n          player.pause();\n          player.volume = this.volumeInternal;\n          return false;\n        }\n        player.volume -= (this.volumeInternal / time) * (timing.delta || 0);\n        return true;\n      }\n      if (timing.count === 0) {\n        player.volume = 0;\n        player.play();\n        return true;\n      }\n      if (time < timing.count) {\n        player.volume = this.volumeInternal;\n        return false;\n      }\n      player.volume += (this.volumeInternal / time) * (timing.delta || 0);\n      return true;\n    }, true);\n    tn.start();\n  }\n\n  fadeAll(dir: 'start' | 'stop', time: number = 1000) {\n    Object\n      .keys(this.players)\n      .forEach((it) => {\n        this.fade(it, dir, time);\n      });\n  }\n\n  play(id?: string) {\n    if (!id) {\n      Object\n        .entries(this.players)\n        .forEach(\n          (it) => {\n            const aud = it[1];\n            if (aud.duration <= 0 || aud.paused) {\n              aud.play();\n            }\n          },\n        );\n      return;\n    }\n    const aud = this.players[id];\n    if (aud.duration <= 0 || aud.paused) {\n      aud.play();\n    }\n  }\n\n  pause(id?: string) {\n    if (!id) {\n      Object.entries(this.players).forEach((it) => it[1].pause());\n      return;\n    }\n    const aud = this.players[id];\n    aud.pause();\n  }\n\n  set volume(value: number) {\n    this.volumeInternal = value;\n    Object.entries(this.players).forEach((it) => { it[1].volume = value; });\n  }\n\n  get volume(): number {\n    return this.volumeInternal;\n  }\n\n  set enabled(value: boolean) {\n    console.log(value);\n    if (value === this.enabled) {\n      return;\n    }\n    if (value) {\n      this.volume = this.muted!;\n      this.muted = undefined;\n    } else {\n      this.muted = this.volume;\n      this.volume = 0;\n    }\n  }\n\n  get enabled(): boolean {\n    return this.muted === undefined;\n  }\n}\n\nconst audio = new AudioTrack();\n\nregisterInitializer((data) => {\n  if (!data.meta || !data.meta.custom_data) {\n    return;\n  }\n  const res = data.meta.custom_data.resources;\n  if (!res) {\n    return;\n  }\n  Object\n    .entries(res.audio || {})\n    .forEach((it) => audio.addTrack(it[0], it[1] as string));\n});\n\nregisterFinalizer(() => audio.clearTrack());\n\nregisterMetaProcessor('line', 'play-music', (value, _, opts) => {\n  const { id, dir: displaying, time } = value;\n  console.log(id, displaying, time, audio.enabled, opts.displaying === (!displaying || displaying === 'true'));\n  if (audio.enabled && opts.displaying === (!displaying || displaying === 'true')) {\n    audio.fade(id, 'start', time || 1000);\n  }\n});\n\nregisterMetaProcessor('line', 'stop-music', (value, _, opts) => {\n  const { id, dir: displaying, time } = value;\n  if (audio.enabled && opts.displaying === (!displaying || displaying === 'true')) {\n    audio.fade(id, 'stop', time || 1000);\n  }\n});\n\nclass MusicControlPanel extends Component {\n  render() {\n    return (\n      <div className=\"music-ui-container\">\n        <input type=\"checkbox\" className=\"music-control-ui-toggle\" id=\"ui-toggle\" />\n        <label htmlFor=\"ui-toggle\" />\n        <div className=\"music-control-ui\">\n          <div className=\"music-enable-ui\">\n            <input\n              type=\"checkbox\"\n              id=\"music-enable\"\n              defaultChecked\n              onChange={(evt) => { audio.enabled = evt.target.checked; }}\n            />\n            <label htmlFor=\"music-enable\" />\n          </div>\n          <div className=\"music-volume-ui\">\n            <input\n              type=\"range\"\n              id=\"music-volume\"\n              min=\"0\"\n              max=\"100\"\n              onChange={(evt) => {\n                audio.volume = parseFloat((evt.target as HTMLInputElement).value) / 100;\n                this.forceUpdate();\n              }}\n            />\n            <label htmlFor=\"music-volume\">\n              <div className=\"vomule-indicator\" style={{ width: `${audio.volume * 162}px` }} />\n            </label>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nregisterComponent('view', 'music', () => <MusicControlPanel />);\n\nexport default {};\n","/* eslint-disable jsx-a11y/media-has-caption */\nimport React, { Component } from 'react';\nimport {\n  registerMetaProcessor,\n  unregisterMetaProcessor,\n  registerComponent,\n  registerInitializer,\n} from '../metaProcessor';\n\ninterface Resources {\n  images: KeyedStorage<string>;\n  videos: KeyedStorage<string>;\n}\n\ninterface Props {\n  resources?: Resources;\n  default_background?: string;\n  default_type?: 'image' | 'video';\n}\n\ninterface State {\n  shown_background?: string;\n  type?: 'image' | 'video'\n  animation_options?: {type: string, time: number};\n}\n\ninterface ChangeBackgroundOptions {\n  next: string;\n  previous: string;\n  time?: number;\n  animtype?: 'fade';\n}\n\ninterface Storage {\n  images: KeyedStorage<string>;\n  videos: KeyedStorage<string>;\n  default_background?: string;\n}\n\nconst storage: Storage = {\n  images: {},\n  videos: {},\n};\n\nclass AnimatedBackground extends Component<{}, State> {\n  constructor(props: {}) {\n    super(props);\n\n    this.state = { shown_background: storage.default_background, type: 'image' };\n  }\n\n  componentDidMount() {\n    registerMetaProcessor('line', 'change-background', this.changeBackground);\n  }\n\n  componentWillUnmount() {\n    unregisterMetaProcessor('line', 'change-background');\n  }\n\n  changeBackground = (val: ChangeBackgroundOptions, _: any, opts: CurrentLineState) => {\n    const { displaying, scroll_dir: dir } = opts;\n\n    if (dir === 'indeterminate') {\n      return;\n    }\n\n    const {\n      next,\n      previous,\n      time: animtime,\n      animtype,\n    } = val;\n    const time = animtime || 500;\n    const type = animtype || 'fade';\n\n    if (!displaying && dir === 'backward') {\n      setTimeout(() => this.setState({\n        shown_background: previous,\n        animation_options: { time, type },\n      }), 10);\n      return;\n    }\n    if (displaying && dir === 'forward') {\n      setTimeout(() => this.setState({\n        shown_background: next,\n        animation_options: { time, type },\n      }), 10);\n    }\n  }\n\n  render() {\n    const { time, type } = this.state.animation_options || {};\n    return (\n      <div className=\"background\" style={{ animationDuration: `${time || 500}ms` }}>\n        {\n          Object\n            .keys(storage.images)\n            .map((it) => ({ id: it, path: storage.images[it] }))\n            .map((it, idx) => (\n              <div\n                className={\n                  `background-image ${type || 'fade'}${\n                    it.id === this.state.shown_background && this.state.type === 'image' ? ' shown' : ''\n                  }`\n                }\n                style={{ backgroundImage: `url(\"${it.path}\")` }}\n                key={idx}\n              />\n            ))\n        }\n        {\n          Object\n            .keys(storage.videos)\n            .map((it) => ({ id: it, path: storage.videos[it] }))\n            .map((it, idx) => (\n              <div\n                className={\n                  `background-wrapper${\n                    it.id === this.state.shown_background && this.state.type === 'video' ? ' shown' : ''\n                  }`\n                }\n                key={idx}\n              >\n                <video className=\"background-video\" src={it.path} />\n              </div>\n            ))\n        }\n      </div>\n    );\n  }\n}\n\nregisterComponent('child', 'background', () => <AnimatedBackground />);\nregisterInitializer((data) => {\n  if (!data.meta) {\n    return;\n  }\n  storage.default_background = data.meta.default_background;\n  if (!data.meta.custom_data) {\n    return;\n  }\n  const res = data.meta.custom_data.resources;\n  if (!res) {\n    return;\n  }\n  storage.images = res.images || {};\n  storage.videos = res.videos || {};\n});\n\nexport default {};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './plugins/rubyPlugin';\nimport './plugins/playMusicPlugin';\nimport './plugins/animatedBackgroundPlugin';\nimport * as serviceWorker from './serviceWorker';\nimport './styles/main.scss';\nimport BackendNovelFetcher from './fetcherimpl/BackendNovelFetcher';\n\nBackendNovelFetcher.initialize({\n  base: 'http://ec2-54-164-152-66.compute-1.amazonaws.com:12354/novels',\n  episode_prefix: '',\n  meta_prefix: '',\n});\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","const mapSeverityToLevel: {[key in ErrorSeverity]: string} = {\r\n  unknown: 'U',\r\n  warn: 'W',\r\n  error: 'E',\r\n  critical: 'C',\r\n};\r\n\r\nexport default class NovelFetchError extends Error {\r\n  public source: FetchErrorType;\r\n\r\n  constructor(source: FetchErrorType) {\r\n    let level: string;\r\n    let phase: FetchPhase;\r\n    let detail: string;\r\n\r\n    if (source === 'novel_not_found') {\r\n      level = 'E';\r\n      phase = 'fetch';\r\n      detail = '小説が見つかりませんでした。';\r\n    } else if (source === 'episode_not_found') {\r\n      level = 'E';\r\n      phase = 'fetch';\r\n      detail = '小説の部分が見つかりませんでした。';\r\n    } else {\r\n      level = mapSeverityToLevel[source.type];\r\n      phase = source.phase;\r\n      detail = source.detail;\r\n    }\r\n    super(`${level}:${phase}:${detail}`);\r\n    this.source = source;\r\n  }\r\n}\r\n"],"sourceRoot":""}